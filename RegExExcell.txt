Sub youTubeTitleFind_inList()
    lastRow = Sheet2.Cells(Rows.Count, 1).End(xlUp).row
    'MsgBox (lastRow)
    
    For i = 1 To lastRow
        cellText = Cells(i, 1).Value
        If InStr(cellText, "href=") Then
            ' 아무 일도 하지 않음
            Cells(i, 1).Value = Trim(Cells(i, 1).Value)
        Else
            ' 내용을 지워야 함
            Cells(i, 1).Value = ""
        End If
    Next i
End Sub

Sub regexpExecute(InStr_, iRow)
    'On Error Resume Next
    
    'Dim InStr_
    Dim pattern_
    Dim inSpect_
    'InStr_ = "45,000원?40,500원?(10%할인)?2,025원(5%적립)"
    'InStr_ = "<a id='endpoint' class='yt-simple-endpoint style-scope ytd-guide-entry-renderer' tabindex='-1' title='이승만TV' href='/channel/UC0ddvpoS9dg3EFWo62VarOA'>"
    'InStr_ = InStr_
    'pattern_ = "[\w,*]+원"
    'pattern_ = "(?<=title=\')[^\']+" '패턴 수식에서 에러남(후방탐색(?<=수식))
    pattern_ = "title=\'[^\']+"
    'MsgBox InStr_
    Set inSpect_ = ReEx_(InStr_, pattern_) 'Set을 사용하지 않으면 에러남
    'MsgBox Not inSpect_ Is Nothing
    'MsgBox inSpect_ ' 에러남
    If Not inSpect_ Is Nothing Then
        'For Each eachReEx In inSpect_
            'MsgBox eachReEx
        'Next eachReEx
        'MsgBox inSpect_
        Cells(iRow, 2).Value = Split(inSpect_(0), "'")(1)
    End If
End Sub

Sub regexpExecute1(InStr_, iRow)
    'On Error Resume Next
    
    'Dim InStr_
    Dim pattern_
    Dim inSpect_
    Dim link_
    
    pattern_ = "href=\'[^\']+"
    'MsgBox InStr_
    Set inSpect_ = ReEx_(InStr_, pattern_)
    'MsgBox Not inSpect_ Is Nothing
    'MsgBox inSpect_ ' 에러남
    If Not inSpect_ Is Nothing Then
        'For Each eachReEx In inSpect_
            'MsgBox eachReEx
        'Next eachReEx
        'MsgBox inSpect_
        link_ = "http://youtube.com" + Split(inSpect_(0), "'")(1)
        'celladdress = Cells(iRow, 2).Address
        'MsgBox link_
        'With Worksheets("Sheet2")
         '   Hyperlinks.Add Anchor:=.Range("C" & iRow), _
          '  Address:="youtube.com/channel/UCUPoOcZy6IuGWsnXhzqyQAQ /channel/UC7XByOuOXCkzmO7R7i7-2bw", _
           ' ScreenTip:="", _
            'TextToDisplay:="김정호"
            '.Select
        'End With
        linkCellValue = Cells(iRow, 2).Value
        With ActiveSheet
            .Hyperlinks.Add Anchor:=.Range("C" & iRow), _
            Address:=link_, _
            ScreenTip:="Microsoft Web Site", _
            TextToDisplay:=linkCellValue
            '커서 링크위에 오버시 툴팁 : ScreenTip
               'ScreenTip부분은 삭제 가능
        End With
    End If
End Sub

Function ReEx_(InStr_, pattern_) As Object
'   On Error Resume Next '에러날 경우 그냥 지나가라
    Dim reEx
    Dim TempReEx
    
    Set reEx = CreateObject("vbscript.regexp")
    With reEx
        '.Global = True
        .Global = False
        .Pattern = pattern_ '날짜: "2019/02/12" 과 "2019/02/12~2019/02/15" 모두 찾음
    End With
    
    If reEx.Test(InStr_) Then
        'MsgBox reEx.Test(InStr_) & " " & i & ": " & celVal_
        Set ReEx_ = reEx.Execute(InStr_) '객체들이 변수에 담길 '반환하는 곳
    End If
    
    Set reEx = Nothing
End Function

Sub AllregEx()
    Sheets("Sheet2").Select
    lastRow = Sheet2.Cells(Rows.Count, 1).End(xlUp).row
    
    For i = 1 To lastRow
        cellText = Cells(i, 1).Value
        Call regexpExecute(cellText, i)
        Call regexpExecute1(cellText, i)
    Next i
End Sub
